---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Layout/Header.astro';
import Seo from '../../components/Seo.astro';
import Footer from '../../components/Layout/Footer.astro';
import { locales, translations, defaultLocale, menu } from '../../data/i18n';
import flag from '../../assets/flags/esp.svg';
import flagP1 from '../../assets/flags/eng.svg';
import flagP2 from '../../assets/flags/fr.svg';
import mojitoImg from '../../assets/menu/mojito.webp';
import Image from 'astro/components/Image.astro';
import CocktailSection from '../../components/Cocktails/CocktailSection.astro';

export async function getStaticPaths() {
  return locales.map((l) => ({ params: { lang: l } }));
}

const { lang } = Astro.params;
const currentPath = new URL(Astro.request.url).pathname;
const canonical = new URL(Astro.request.url).href;
const t = translations[lang as keyof typeof translations] ?? translations[defaultLocale];

// Build a drinks array for the CocktailSection using the consolidated `menu`
const cocktailsSection = menu.sections.find((s: any) => s.id === 'cocktails');
const drinks = (cocktailsSection?.items ?? []).map((item: any, i: number) => ({
  id: `cocktail-${i}`,
  title: item.name?.[lang] ?? item.name?.[defaultLocale] ?? item.id,
  subtitle: item.description?.[lang] ?? item.description?.[defaultLocale] ?? '',
  types: [item.name?.[lang] ?? item.name?.[defaultLocale] ?? item.id],
  image: mojitoImg,
  backgroundImage: item.backgroundImage ? item.backgroundImage : mojitoImg,
  imageAlt: item.name?.[lang] ?? item.name?.[defaultLocale] ?? item.id,
  reverse: false,
  variant: 'cocktail'
}));

---


<Seo title={t.seo.cocktails.title} description={t.seo.cocktails.description} canonical={canonical} lang={lang} business={{
  name: t.siteName,
  description: t.seo.cocktails.description,
  address: t.contactAddress,
  telephone: t.contactPhone,
  email: t.contactEmail,
  openingHours: t.contactHours,
  openingHoursSpecification: t.openingHoursSpecification,
  image: '/assets/logos/koj_logo.png',
  type: 'Bar',
  sameAs: [
    'https://www.instagram.com/kingofjudahreggae/',
    'https://www.tripadvisor.com/Attraction_Review-g187482-d13817854-Reviews-King_Of_Judah_Reggae_Bar-Santa_Cruz_de_Tenerife_Tenerife_Canary_Islands.html',
    'https://www.facebook.com/KingOfJudahTenerife'
  ]
}} />

<Layout lang={lang}>
  <Header flagImg={flag} flagImgP1={flagP1} flagImgP2={flagP2} currentLang={lang} currentPath={currentPath} homeTxt={t.home} cocktailsTxt={t.cocktails} contactTxt={t.contact} />

  <main class=" h-fit bg-linear-to-br from-green-950 via-yellow-900 to-red-900">
    <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold animate-pulse mb-4 py-12 text-center">{t.cocktails}</h1>

    <nav class=" flex gap-2 flex-wrap justify-center">
      {menu.sections.map(section => (
        <a class="btn btn-sm" href={`#${section.id}`}>{section.title?.[lang] ?? section.title?.[defaultLocale] ?? section.id}</a>
      ))}
    </nav>

    <!-- Render the CocktailSection component first (uses optimized images) -->
    <CocktailSection drinks={drinks} />

    
  </main>

  <Footer />
</Layout>

