---
import { defaultLocale, locales } from '../data/i18n';
---

<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<!-- Fallback for users without JavaScript -->
		<meta http-equiv="refresh" content={"0; url=/" + defaultLocale + "/"} />
		<title>Detecting language...</title>
		<script>
			// Client-side language detection and redirect.
			(function() {
				try {
					const supported = JSON.parse('["es","en","fr"]');
					const defaultLocale = 'en';
					const nav = (navigator.languages && navigator.languages.length) ? navigator.languages : [navigator.language || ''];
					let detected = null;
					for (const l of nav) {
						if (!l) continue;
						const code = l.split('-')[0].toLowerCase();
						if (supported.includes(code)) { detected = code; break; }
					}
					const target = detected || defaultLocale;
					// Use replace so back button doesn't return to this page
					location.replace('/' + target + '/');
				} catch (e) {
					// If anything goes wrong, fallback to server-side meta refresh
					console.error('Language detection failed:', e);
				}
			})();
		</script>
	</head>
	<body>
		<p>Redirecting to <a href={'/' + defaultLocale + '/'}>{'/' + defaultLocale + '/'}</a></p>
	</body>
</html>

